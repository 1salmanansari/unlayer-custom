const editorTemplate=`<button id="addBanner" class="button" style="color: ${theme.secondary};background-color:${theme.primary};">Add Banner</button>`,logoItemsTemplate=_.template('\n<% _.forEach(banners, function(item) { %>\n  <div class="product-item" id="product-item" data-uuid=\'<%= item.id %>\' data-image="<%= item.img %>" >\n  <img src="<%= item.img %>" style="max-height: 150px;min-height: 100px;width: 100%;" />\n  </div>\n<% }); %>\n'),modalTemplate=function(e){return`\n  <div class="modal" id="product_library_modal">\n    <div class="modal-dialog modal-dialog-centered">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3 class="modal-title">Banner List</h3>\n          <button class="close" id="modalCloseBtn">&times;</button>\n        </div>\n        <div class="modal-body">\n        <div>\n        <div class="search-box">\n        <p id='search-bar'></p>\n        <p id='search-btn'></p>\n        </div>   \n        </div>\n          <div class="products-list">\n            ${logoItemsTemplate(e)}\n          </div>\n        </div>\n        <div class="modal-footer">\n        </div>\n      </div>\n    </div>\n  </div>\n`},toolTemplate=function(e,t=!1){const{logo_image:n={}}=e||{},o=n&&n.url?n.url:"";return`<div class="product-card" style="position:relative;display:table;min-width:0;word-wrap:break-word;background-color:#fff;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:4px;margin:auto;text-align:center;">\n    <img src="${o||"https://s3.amazonaws.com/unroll-images-production/projects%2F167%2F1643875820464-188690"}" style="width: 100%; object-fit: contain; border-top-left-radius: 4px; border-top-right-radius: 4px;" />\n  </div>\n  ${t?(a={banners:e.data.banners},`\n  <div class="modal" id="product_library_modal">\n    <div class="modal-dialog modal-dialog-centered">\n      <div class="modal-content">\n        <div class="modal-header">\n          <h3 class="modal-title">Banner List</h3>\n          <button class="close" id="modalCloseBtn">&times;</button>\n        </div>\n        <div class="modal-body">\n        <div>\n        <div class="search-box">\n        <p id='search-bar'></p>\n        <p id='search-btn'></p>\n        </div>   \n        </div>\n          <div class="products-list">\n            ${logoItemsTemplate(a)}\n          </div>\n        </div>\n        <div class="modal-footer">\n        </div>\n      </div>\n    </div>\n  </div>\n`):""}`;var a},toolEmailTemplate=function(e,t=!1){const n=e&&e.bannerLibrary&&e.bannerLibrary.selected&&e.bannerLibrary.selected.id?e.bannerLibrary.selected.id:"";return`\n    <table logoId="${n}" cellspacing="0" cellpadding="0" style="position:relative;min-width:0;word-wrap:break-word;background-color:#fff;background-clip:border-box;border:1px solid rgba(0,0,0,.125);border-radius:4px;margin:auto;text-align:center;">\n      <tbody>\n        <tr><td width="100%"><img id="${n}-logo" src="${e&&e.logo_image&&e.logo_image.url?e.logo_image.url:"https://s3.amazonaws.com/unroll-images-production/projects%2F167%2F1643875820464-188690"}" style="width: 100%; object-fit: contain; border-top-left-radius: 4px; border-top-right-radius: 4px;" /></td></tr>\n      </tbody>\n    </table>\n  `},showModal=function(){document.getElementById("product_library_modal").classList.add("show")},hideModal=function(){document.getElementById("product_library_modal").classList.remove("show")};unlayer.registerPropertyEditor({name:"community_banner_library",layout:"bottom",Widget:unlayer.createWidget({render:(e,t,n)=>editorTemplate,mount(e,t,n,o){e.querySelector("#addBanner").onclick=function(){document.getElementById("product_library_modal").classList.add("show"),setTimeout(()=>{const e=document.querySelector(".products-list");e&&(e.onclick=function(e){if("product-item"===e.target.id){const t=o.banners.find(t=>t.id===parseInt(e.target.dataset.uuid));n({selected:t})}else{const t=e.target.parentElement;if(t&&"product-item"!==t.id)return;const a=o.banners.find(e=>e.id===parseInt(t.dataset.uuid));n({selected:a})}hideModal(),document.querySelector("#u_body").click()},document.querySelector("#modalCloseBtn").onclick=hideModal)},200)}}})}),unlayer.registerTool({name:"community_banner_tool",label:"Banners",icon:"fa-images",supportedDisplayModes:["web","email"],options:{bannerContent:{title:"Community Banner Content",position:1,options:{bannerLibrary:{label:"Add a banner from store",defaultValue:"",widget:"community_banner_library"}}}},transformer:(e,t)=>{const{name:n,value:o={},data:a}=t||{},{selected:d={}}=o||{},r=d&&d.id?d.id:"",i=d&&d.img?d.img:"";return"bannerLibrary"===n?{...e,id:r,logo_image:{url:i}}:{...e}},values:{},renderer:{Viewer:unlayer.createViewer({render:e=>toolTemplate(e,!0)}),exporters:{web:e=>toolTemplate(e),email:e=>toolEmailTemplate(e)},head:{css(e){},js(e){}}}});
